<?xml version="1.0"?>
<QuickForm xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="e0ff7ba9-fdaa-4002-8fc5-4d592506a2d3" DefinitionType="Sage.Platform.QuickForms.QuickFormMainDetailViewDefinition, Sage.Platform.QuickForms">
  <ActiveControl />
  <ImagePath />
  <LoadActions>
    <FormActionDefinition>
      <ResourceKey>1a81f3c6-d665-446e-ac99-662726c2c454</ResourceKey>
      <Action typeName="Sage.Platform.QuickForms.ActionItems.CSharpSnippetActionItem, Sage.Platform.QuickForms">
        <CSharpSnippetActionItem>
          <MethodName>quickformload0</MethodName>
          <CSharpCodeSnippet>	//Onload restrict button based on account type
	Sage.Entity.Interfaces.IAccount account = BindingSource.Current as Sage.Entity.Interfaces.IAccount;
	
	switch(account.Type) {
		case "Distributor":
			cmdAddSalesOrder.Visible = true;
			cmdAddReturnOrder.Visible = true;
			cmdAddTransferOrder.Visible = true;
			cmdAddInventoryOrder.Visible = true;
			break;
		case "Sales Rep":
			cmdAddSalesOrder.Visible = true;
			cmdAddReturnOrder.Visible = true;
			cmdAddTransferOrder.Visible = true;
			cmdAddInventoryOrder.Visible = true;
			break;
			
		default:
			cmdAddSalesOrder.Visible = true;
			cmdAddReturnOrder.Visible = true;
			cmdAddTransferOrder.Visible = false;
			cmdAddInventoryOrder.Visible = false;
			break;		
	}</CSharpCodeSnippet>
        </CSharpSnippetActionItem>
      </Action>
      <IsDialogCloseAction>False</IsDialogCloseAction>
      <RunOnEveryRePaint>False</RunOnEveryRePaint>
      <DialogActionResult>NoResult</DialogActionResult>
      <PerformsUpdate>False</PerformsUpdate>
      <AppliedSecurity />
      <RefreshData>False</RefreshData>
    </FormActionDefinition>
  </LoadActions>
  <Name>AccountSalesOrders</Name>
  <ClientScriptIncludes />
  <ClientResourceKeys />
  <ExtendedProperties />
  <HelpFile />
  <ReadOnly>false</ReadOnly>
  <GeneratePrintView>false</GeneratePrintView>
  <Controls>
    <Control typeName="Sage.SalesLogix.QuickForms.QFControls.QFDataGrid, Sage.SalesLogix.QuickForms.QFControls">
      <QFDataGrid>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>grdSalesOrders</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <DataSource>dsSalesOrders</DataSource>
        <EnablePaging>true</EnablePaging>
        <EnableSorting>true</EnableSorting>
        <PageSize>10</PageSize>
        <Columns>
          <QFLinkCol>
            <StyleScheme />
            <DataField>SalesOrderNumber</DataField>
            <ColumnId>40c5884b-4484-49d9-9d1e-3ec31d589e08</ColumnId>
            <HorizontalAlignment>left</HorizontalAlignment>
            <HeaderAlignment>left</HeaderAlignment>
            <SortDirection>None</SortDirection>
            <IsSortable>true</IsSortable>
            <SortField>SalesOrderNumber</SortField>
            <MultiCurrencyDependent>false</MultiCurrencyDependent>
            <Destination />
            <Image />
            <EntityIdField>Id</EntityIdField>
            <EntityTypeName>SalesOrder</EntityTypeName>
            <Target />
            <AppliedSecurity />
          </QFLinkCol>
          <QFDataGridCol>
            <StyleScheme />
            <DataField>OrderType</DataField>
            <ColumnId>fb3a61e8-a62f-4df2-b566-c771f30f8625</ColumnId>
            <HorizontalAlignment>left</HorizontalAlignment>
            <HeaderAlignment>left</HeaderAlignment>
            <SortDirection>None</SortDirection>
            <IsSortable>true</IsSortable>
            <SortField>OrderType</SortField>
            <MultiCurrencyDependent>false</MultiCurrencyDependent>
          </QFDataGridCol>
          <QFDataGridCol>
            <StyleScheme />
            <DataField>Status</DataField>
            <ColumnId>1806aa1b-8436-491e-8c56-1ac9d98280b7</ColumnId>
            <HorizontalAlignment>left</HorizontalAlignment>
            <HeaderAlignment>left</HeaderAlignment>
            <SortDirection>None</SortDirection>
            <IsSortable>true</IsSortable>
            <SortField>Status</SortField>
            <MultiCurrencyDependent>false</MultiCurrencyDependent>
          </QFDataGridCol>
          <QFDataGridCol>
            <StyleScheme />
            <DataField>BillToName</DataField>
            <ColumnId>099c10a1-7611-44f3-92c8-d6686f701a71</ColumnId>
            <HorizontalAlignment>left</HorizontalAlignment>
            <HeaderAlignment>left</HeaderAlignment>
            <SortDirection>None</SortDirection>
            <IsSortable>true</IsSortable>
            <SortField>BillToName</SortField>
            <MultiCurrencyDependent>false</MultiCurrencyDependent>
          </QFDataGridCol>
          <QFDataGridCol>
            <StyleScheme />
            <DataField>ShipToName</DataField>
            <ColumnId>8ceb34cd-5e95-4e9a-921e-c810ed281dbc</ColumnId>
            <HorizontalAlignment>left</HorizontalAlignment>
            <HeaderAlignment>left</HeaderAlignment>
            <SortDirection>None</SortDirection>
            <IsSortable>true</IsSortable>
            <SortField>ShipToName</SortField>
            <MultiCurrencyDependent>false</MultiCurrencyDependent>
          </QFDataGridCol>
          <QFPickListCol>
            <StyleScheme />
            <DataField>ShipVia</DataField>
            <ColumnId>cc919862-34ef-4e0f-9157-8f1b019795f6</ColumnId>
            <HorizontalAlignment>left</HorizontalAlignment>
            <HeaderAlignment>left</HeaderAlignment>
            <SortDirection>None</SortDirection>
            <IsSortable>true</IsSortable>
            <SortField>ShipVia</SortField>
            <MultiCurrencyDependent>false</MultiCurrencyDependent>
            <PickListName>Delivery Methods</PickListName>
            <PickListId />
            <ValueStoredAsText>false</ValueStoredAsText>
            <AllowMultiples>false</AllowMultiples>
            <AlphaSort>false</AlphaSort>
            <MustExistInList>false</MustExistInList>
            <NoneEditable>false</NoneEditable>
          </QFPickListCol>
          <QFDataGridCol>
            <StyleScheme />
            <DataField>CustomerPurchaseOrderNumber</DataField>
            <ColumnId>15f01097-c071-4a30-bca8-b1f3d7ff6616</ColumnId>
            <HorizontalAlignment>left</HorizontalAlignment>
            <HeaderAlignment>left</HeaderAlignment>
            <SortDirection>None</SortDirection>
            <IsSortable>true</IsSortable>
            <SortField>CustomerPurchaseOrderNumber</SortField>
            <MultiCurrencyDependent>false</MultiCurrencyDependent>
          </QFDataGridCol>
          <QFDeleteCol>
            <StyleScheme />
            <DataField />
            <ColumnId>e9313b46-2561-4fa5-95be-a8fc64b4ca6f</ColumnId>
            <HorizontalAlignment>left</HorizontalAlignment>
            <HeaderAlignment>left</HeaderAlignment>
            <SortDirection>None</SortDirection>
            <IsSortable>false</IsSortable>
            <MultiCurrencyDependent>false</MultiCurrencyDependent>
            <BusinessRule />
            <BusinessRuleParameters />
            <AppliedSecurity />
          </QFDeleteCol>
        </Columns>
        <RenderVertical>false</RenderVertical>
        <OnRowSelectedAction>
          <ResourceKey>grdSalesOrders</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.NoActionActionItem, Sage.Platform.QuickForms">
            <NoActionActionItem>
              <MethodName />
            </NoActionActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnRowSelectedAction>
      </QFDataGrid>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.QFControls.QFDataSource, Sage.Platform.QuickForms.QFControls">
      <QFDataSource>
        <Column>0</Column>
        <Row>1</Row>
        <Visible>false</Visible>
        <HotKey>48</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>dsSalesOrders</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <EntityTypeName>SalesOrder</EntityTypeName>
        <GetByMethod />
        <GetByProperty>SalesOrders</GetByProperty>
        <UseSmartSelection>true</UseSmartSelection>
        <DataOptional>false</DataOptional>
      </QFDataSource>
    </Control>
  </Controls>
  <ToolControls>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFElementSpacer, Sage.Platform.QuickForms">
      <QFElementSpacer>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId />
        <DataBindings />
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
      </QFElementSpacer>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFElementSpacer, Sage.Platform.QuickForms">
      <QFElementSpacer>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId />
        <DataBindings />
        <ControlLabelPlacement>left</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
      </QFElementSpacer>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>0</Column>
        <Row>0</Row>
        <Visible>false</Visible>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>btnInserSalesOrder</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>Icon</ButtonType>
        <Image>[Localization!Global_Images:plus_16X16]</Image>
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>btnInserSalesOrder</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.RedirectActionItem, Sage.Platform.QuickForms">
            <RedirectActionItem>
              <MethodName>btnInserSalesOrder_ClickAction</MethodName>
              <RawURL>~/InsertSalesOrder.aspx?modeid=Insert&amp;type=SO</RawURL>
              <MainViewEntityName />
              <UseCurrentIdInLink>true</UseCurrentIdInLink>
              <EntityViewMode>Detail</EntityViewMode>
            </RedirectActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity>ENTITIES/SALESORDER/ADD</AppliedSecurity>
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>cmdAddSalesOrder</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>StandardButton</ButtonType>
        <Image />
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>cmdAddSalesOrder</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.CSharpSnippetActionItem, Sage.Platform.QuickForms">
            <CSharpSnippetActionItem>
              <MethodName />
              <CSharpCodeSnippet>//Create Sales Order
	Sage.Entity.Interfaces.IAccount account = this.BindingSource.Current as Sage.Entity.Interfaces.IAccount;
	
	string salesOrderId = account.CreateSalesOrder("SO");
	
	
    // Update the 
    // ==================================================================================================================
    // TAC Code here needed to use this method for Performance reasons only as the Entity Model is too Slow
    //====================================================================================================================
    string pSQL = "Update SALESORDERITEMS Set SalesOrderid = '" + salesOrderId + "' where TacAccountid = '" + account.Id.ToString() + "' and SalesOrderID = 'TEMP'";
    pSQL += " AND (PRODUCTID IN";
    pSQL += "                      (SELECT     sysdba.PRODUCT.PRODUCTID";
    pSQL += " FROM         sysdba.PRODUCT INNER JOIN";
    pSQL += "                 sysdba.SITE ON sysdba.PRODUCT.WAREHOUSEID = sysdba.SITE.SITECODE INNER JOIN";
    pSQL += "                  sysdba.SALESORDER ON sysdba.SITE.SITEID = sysdba.SALESORDER.USERWHSEID";
    pSQL += " WHERE     (sysdba.SALESORDER.SALESORDERID = '" + salesOrderId + "')))";
	
	
	string SQL_iCountAccountStockCardItems = "Select Count(*) from sysdba.StockCardItems where Accountid = '" + account.Id.ToString () + "'";
    string SQL_iCountSalesOrderItems = "Select Count(*) from sysdba.SalesOrderItems  where TacAccountid = '" + account.Id.ToString() + "' and SalesOrderID = 'TEMP'";
    int iCountAccountStockCardItems = 0;
    int iCountSalesOrderItems =0;
        Sage.Platform.Data.IDataService datasvc = Sage.Platform.Application.ApplicationContext.Current.Services.Get&lt;Sage.Platform.Data.IDataService&gt;();
        using (System.Data.OleDb.OleDbConnection conn = new System.Data.OleDb.OleDbConnection(datasvc.GetConnectionString()))
        {
            conn.Open();

            using (System.Data.OleDb.OleDbCommand cmd = new System.Data.OleDb.OleDbCommand(SQL_iCountAccountStockCardItems, conn))
            {
            //Check to see if the Accounts Stock Cards Match the Current Number of SalesOrderItems
                iCountAccountStockCardItems = (int)cmd.ExecuteScalar();
               
            }
            using (System.Data.OleDb.OleDbCommand cmd = new System.Data.OleDb.OleDbCommand(SQL_iCountSalesOrderItems, conn))
            {
                //Check to see if the Accounts Stock Cards Match the Current Number of SalesOrderItems
                iCountSalesOrderItems = (int)cmd.ExecuteScalar();

            }
            if (iCountAccountStockCardItems == iCountSalesOrderItems)
            {
                // Counts are the Same so Run the Update Statement
                using (System.Data.OleDb.OleDbCommand cmd = new System.Data.OleDb.OleDbCommand(pSQL, conn))
                {
                    //Update the Temp Items
                    cmd.ExecuteNonQuery();

                }

            }
            else
            {
                //Counts are not the Same so Run Process to  create or Update them
                //==============================================================================
                // Create new TEMP SalesItems using External Executable
                //==============================================================================
                string apPath = System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath;

                System.Diagnostics.Process process1 = new System.Diagnostics.Process();
                process1.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden; //Hidden window

                // Set the directory where the file resides

                process1.StartInfo.WorkingDirectory = apPath + "Bin";
                // Set the filename name of the file you want to open

                process1.StartInfo.FileName = apPath + "Bin\\EABItemUpdater.exe";
                string myargs = "\"-Accountid=" + account.Id.ToString() + "`" + datasvc.GetConnectionString() + "\"";

                process1.StartInfo.Arguments = myargs;
                // Start the process
                process1.Start();
                process1.WaitForExit();
                // Counts are the Same Now so Run the Update Statement
                using (System.Data.OleDb.OleDbCommand cmd = new System.Data.OleDb.OleDbCommand(pSQL, conn))
                {
                    //Update the Temp Items
                    cmd.ExecuteNonQuery();

                }
                
            }
        }
    
    //==============================================================================
    // Create new TEMP SalesItems using External Executable
    //==============================================================================
        string apPath1 = System.Web.Hosting.HostingEnvironment.ApplicationPhysicalPath;
        
        System.Diagnostics.Process process2 = new System.Diagnostics.Process();
        process2.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden; //Hidden window
    
        // Set the directory where the file resides

        process2.StartInfo.WorkingDirectory = apPath1 + "Bin";
        // Set the filename name of the file you want to open

        process2.StartInfo.FileName = apPath1 +  "Bin\\EABItemUpdater.exe";
        string myargs1 = "\"-Accountid=" +account.Id.ToString () + "`"+ datasvc.GetConnectionString()+ "\"";
        
        process2.StartInfo.Arguments = myargs1;
        // Start the process
        process2.Start();
       // Do Not Wait for Exit
    
	//redirect to new salesorder
	Response.Redirect(String.Format("SalesOrder.aspx?entityId={0}", salesOrderId));
</CSharpCodeSnippet>
            </CSharpSnippetActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>cmdAddTransferOrder</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>StandardButton</ButtonType>
        <Image />
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>cmdAddTransferOrder</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.CSharpSnippetActionItem, Sage.Platform.QuickForms">
            <CSharpSnippetActionItem>
              <MethodName>cmdAddTransferOrder_ClickAction</MethodName>
              <CSharpCodeSnippet>	//Create Sales Order
	Sage.Entity.Interfaces.IAccount account = this.BindingSource.Current as Sage.Entity.Interfaces.IAccount;
	
	string salesOrderId = account.CreateSalesOrder("TO");
	
	//redirect to new salesorder
	Response.Redirect(String.Format("SalesOrder.aspx?entityId={0}", salesOrderId));</CSharpCodeSnippet>
            </CSharpSnippetActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>cmdAddReturnOrder</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>StandardButton</ButtonType>
        <Image />
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>cmdAddReturnOrder</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.CSharpSnippetActionItem, Sage.Platform.QuickForms">
            <CSharpSnippetActionItem>
              <MethodName>cmdAddReturnOrder_ClickAction</MethodName>
              <CSharpCodeSnippet>	//Create Sales Order
	Sage.Entity.Interfaces.IAccount account = this.BindingSource.Current as Sage.Entity.Interfaces.IAccount;
	
	string salesOrderId = account.CreateSalesOrder("RO");
	
	//redirect to new salesorder
	Response.Redirect(String.Format("SalesOrder.aspx?entityId={0}", salesOrderId));</CSharpCodeSnippet>
            </CSharpSnippetActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>0</Column>
        <Row>0</Row>
        <Visible>false</Visible>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>cmdAddPurchaseOrder</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>StandardButton</ButtonType>
        <Image />
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>cmdAddPurchaseOrder</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.CSharpSnippetActionItem, Sage.Platform.QuickForms">
            <CSharpSnippetActionItem>
              <MethodName>cmdAddPurchaseOrder_ClickAction</MethodName>
              <CSharpCodeSnippet>	//Create Sales Order
	Sage.Entity.Interfaces.IAccount account = this.BindingSource.Current as Sage.Entity.Interfaces.IAccount;
	
	string salesOrderId = account.CreateSalesOrder("PO");
	
	//redirect to new salesorder
	Response.Redirect(String.Format("SalesOrder.aspx?entityId={0}", salesOrderId));</CSharpCodeSnippet>
            </CSharpSnippetActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
    <Control typeName="Sage.Platform.QuickForms.Controls.QFButton, Sage.Platform.QuickForms">
      <QFButton>
        <Column>0</Column>
        <Row>0</Row>
        <HotKey>0</HotKey>
        <TabIndex>0</TabIndex>
        <ControlId>cmdAddInventoryOrder</ControlId>
        <DataBindings />
        <ControlLabelPlacement>none</ControlLabelPlacement>
        <ExtendedProperties />
        <CaptionAlignment>left</CaptionAlignment>
        <StyleScheme />
        <ButtonType>StandardButton</ButtonType>
        <Image />
        <OnClientClick />
        <OnClickAction>
          <ResourceKey>cmdAddInventoryOrder</ResourceKey>
          <Action typeName="Sage.Platform.QuickForms.ActionItems.CSharpSnippetActionItem, Sage.Platform.QuickForms">
            <CSharpSnippetActionItem>
              <MethodName>cmdAddInventoryOrder_ClickAction</MethodName>
              <CSharpCodeSnippet>	//Create Sales Order
	Sage.Entity.Interfaces.IAccount account = this.BindingSource.Current as Sage.Entity.Interfaces.IAccount;
	
	string salesOrderId = account.CreateSalesOrder("IO");
	
	//redirect to new salesorder
	Response.Redirect(String.Format("SalesOrder.aspx?entityId={0}", salesOrderId));</CSharpCodeSnippet>
            </CSharpSnippetActionItem>
          </Action>
          <IsDialogCloseAction>False</IsDialogCloseAction>
          <RunOnEveryRePaint>False</RunOnEveryRePaint>
          <DialogActionResult>NoResult</DialogActionResult>
          <PerformsUpdate>False</PerformsUpdate>
          <AppliedSecurity />
          <RefreshData>False</RefreshData>
        </OnClickAction>
      </QFButton>
    </Control>
  </ToolControls>
  <Columns>
    <ColumnStyle>
      <SizeType>Percent</SizeType>
      <Width>100</Width>
    </ColumnStyle>
  </Columns>
  <Rows>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>53</Height>
    </RowStyle>
    <RowStyle>
      <SizeType>Absolute</SizeType>
      <Height>53</Height>
    </RowStyle>
  </Rows>
  <Description />
  <UseEntityNameAsTitle>false</UseEntityNameAsTitle>
  <EntityTypeName>IAccount</EntityTypeName>
  <DefaultNamespace>Sage.Entity.Interfaces</DefaultNamespace>
  <AssemblyName>Sage.Entity.Interfaces</AssemblyName>
</QuickForm>